{% extends "base.html" %}

{% block title %}Dashboard{% endblock %}

{% block content %}
<h1>Dashboard</h1>

<div style="display: flex; gap: 20px; margin-bottom: 20px; flex-wrap: wrap;">
    <div class="card" style="flex: 1; min-width: 300px;">
        <h3>Add Customer</h3>
        <form method="POST" action="{{ url_for('main.create_customer') }}">
            <div class="form-group">
                <label>Name:</label>
                <input type="text" name="name" required>
            </div>
            <div class="form-group">
                <label>Phone:</label>
                <input type="text" name="phone" required>
            </div>
            <button type="submit" class="btn btn-primary">Add Customer</button>
        </form>
    </div>

    <div class="card" style="flex: 1; min-width: 300px;">
        <h3>Create Order</h3>
        <form method="POST" action="{{ url_for('main.create_order') }}">
            <div class="form-group">
                <label>Customer:</label>
                <select name="customer_id" required>
                    <option value="">Select Customer</option>
                    {% for customer in customers %}
                        <option value="{{ customer.id }}">{{ customer.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="form-group">
                <label>Order Name:</label>
                <input type="text" name="order_name" required>
            </div>
            <div class="form-group">
                <label>Price:</label>
                <input type="number" step="0.01" name="price" required>
            </div>
            <button type="submit" class="btn btn-success">Create Order</button>
        </form>
    </div>
</div>

<div style="display: flex; gap: 20px; flex-wrap: wrap;">
    <div class="card" style="flex: 1; min-width: 300px;">
        <h3>Customers ({{ customers|length }})</h3>
        {% if customers %}
            <table>
                <tr>
                    <th>Name</th>
                    <th>Phone</th>
                    <th>Orders</th>
                </tr>
                {% for customer in customers %}
                <tr>
                    <td>{{ customer.name }}</td>
                    <td>{{ customer.phone }}</td>
                    <td>{{ customer.orders|length }}</td>
                </tr>
                {% endfor %}
            </table>
        {% else %}
            <p>No customers yet.</p>
        {% endif %}
    </div>

    <div class="card" style="flex: 1; min-width: 300px;">
        <h3>Orders ({{ orders|length }})</h3>
        {% if orders %}
            <table>
                <tr>
                    <th>Order</th>
                    <th>Customer</th>
                    <th>Price</th>
                    <th>Date</th>
                    <th>Action</th>
                </tr>
                {% for order in orders %}
                <tr>
                    <td>{{ order.order_name }}</td>
                    <td>{{ order.customer.name }}</td>
                    <td>${{ "%.2f"|format(order.price) }}</td>
                    <td>{{ order.created_at.strftime('%m/%d/%Y') }}</td>
                    <td>
                    <form method="POST" action="{{ url_for('main.delete_order', order_id=order.id) }}" style="display:inline;">
                        <button 
                            type="submit" 
                            class="btn btn-danger"
                            onclick="return confirm('Are you sure you want to delete this order?');">
                            Delete
                        </button>
                    </form>
                </td>
                    
                </tr>
                {% endfor %}
            </table>
        {% else %}
            <p>No orders yet.</p>
        {% endif %}
    </div>
</div>
{% endblock %}